<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml" xmlns:fb="http://ogp.me/ns/fb#"><head><link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
        <link rel="icon" type="image/svg+xml" href="/favicon/favicon.svg" />
        <link rel="shortcut icon" href="/favicon/favicon.ico" />
        <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon.png" />
        <link rel="manifest" href="/favicon/site.webmanifest" /><meta name="viewport" content="width=device-width, initial-scale=0.85"><meta charset="UTF-8"><title>One-Radio</title>
<meta property="og:image" content="/assets/default.png" />
<link rel="preload" href="https://internetradioprotocol.org/info" as="fetch" crossorigin="anonymous">


<!-- STATION_DATA_START -->
<!-- STATION_DATA_END --></head><body style="font-family:Archivo Light; padding:5vw; padding-top:10px;">

        <div id="modal-container">
            <div id="modal-bg" onClick="closeModal();"></div>
            <div id="modal">
                <div id="modal-x-container"><div id="modal-x" onClick="closeModal();">X</div></div>
                <div id="modal-content">
                    <div id="modal-logo-container">
                        <div class="logo-and-overlay">
                            <div id="modal-play-overlay" class="play-overlay">
                                <svg viewBox="0 0 100 100" width="60%" height="60%">
                                    <polygon points="30,20 30,80 75,50" fill="white" stroke="black" stroke-width="2"/>
                                </svg>
                            </div>
                            <img id="modal-logo"  src="" />
                    </div>
                        <div id="modal-name-and-location">
                            <div id="modal-station-name"></div>
                            <div id="modal-station-location"></div>
                        </div>
                    </div>
                    <div id="modal-links-container">
                            <a class="a-link" id="modal-main-link" target="_blank" href="">Website</a>
                            <a class="a-link" id="modal-stream-link" target="_blank" href="">Stream</a>
                            <a class="a-link info-link" id="modal-info-link" target="_blank" href="">Data</a>
                            <a class="a-link support-link" id="modal-support-link" target="_blank" href="">Donate</a>
                    </div>
                    <div id="modal-description-container">
                        
                    </div>
                </div>
                
            </div>
        </div>
        
        <div class="the-header" style="display:flex; align-items:center;">
        <img id="main-logo" src="assets/ears.png">
        <p id="title">On<span style="letter-spacing:-0.045em">e</span><span style="letter-spacing:-0.35em">-</span>
-Radio</p></div>
        <div id="play-random">
            <!--<div id="play-random-button">&#x25b6;&#xfe0e;</div>-->
            <div id="play-random-button"><img id="shuffle" src="assets/shuffle.png"></div>
            <div id="play-random-text">
            </div>
            <div id="intro-div"></div>
        </div>
        <div id="player">
            <div id="player-icons">
                <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M24 22h-24l12-20z"></path></svg>
                <svg id="pause-icon" xmlns="http://www.w3.org/2000/svg" version="1.0" width="1262.000000pt" height="1280.000000pt" viewBox="0 0 1262.000000 1280.000000" preserveAspectRatio="xMidYMid meet"><g transform="translate(0.000000,1280.000000) scale(0.100000,-0.100000)" fill="rgb(0,0,0,255)" stroke="#000000" stroke-width="0"><path d="M669 12214 c-59 -18 -130 -81 -160 -141 l-24 -48 0 -5650 0 -5650 23 -47 c13 -26 43 -65 67 -87 83 -77 -104 -71 2295 -71 2400 0 2212 -6 2295 71 24 23 54 62 67 87 l23 47 0 5650 0 5650 -23 47 c-13 25 -43 64 -67 87 -83 77 105 71 -2299 70 -1824 0 -2158 -3 -2197 -15z"></path><path d="M7542 12211 c-63 -22 -123 -76 -155 -141 l-22 -45 0 -5650 0 -5650 23 -47 c13 -25 43 -64 67 -87 83 -77 -105 -71 2295 -71 2399 0 2212 -6 2295 71 24 22 54 61 67 87 l23 47 0 5650 0 5650 -24 48 c-31 63 -101 123 -164 142 -44 13 -321 15 -2201 15 -2062 -1 -2153 -1 -2204 -19z"></path></g></svg>
            </div>
            <div id="player-things">
                <img id="player-img" src="">
                <div id="player-info-div">
                    <div id="player-name"></div>
                    <div id="player-info"><span class="one-liner" style="font-size: 10pt !important;"></span></div>
                    <div id="player-tags"></div>
                </div>
                <audio id="player-audio" style="width:40px;" data-src=""></audio>
            </div>
            <div id="share-icon">
                <i id="share" class="fa-solid fa-link"></i>
            </div>
        </div>
        <!--<div id="intro-div">Up-to-the-minute information and direct stream links for the world's best internet radio stations. Click a logo to tune in, donate to a station if you like it, and follow me on Instagram, <a class='insta-link' target='_blank' href='https://www.instagram.com/scud.works/'>@scud.works</a>. Last updated <span class='last-updated'></span><span class='live-count'></span>.</div>-->
        
        <div class="tag-container-container">
            <div class="tags-container" id="status-tags-container">
                <div class="tag status-tag" data-type="status" id="Live-tag">Live</div>
                <div class="tag status-tag" data-type="status" id="Re-Run-tag">Re-Run</div>
                <div class="tag status-tag" data-type="status" id="Offline-tag">Offline</div>
            </div>
            <div class="tags-container" id="location-tags-container">
            </div>
            <div class="tags-container" id="genre-tags-container">
            </div>
        </div>

        <div class="streams-container" id="favorites-container"></div>

        <div id="change-sort-button" onclick="sortStations(true)">
            <img id="change-sort-icon">
        </div>
        
        <div class="streams-container" id="streams-container"></div>
    Up-to-the-minute information and direct stream links for the world's best internet radio stations. Click a logo to tune in, donate to a station if you like it, and follow me on Instagram, <a class='insta-link' target='_blank' href='https://www.instagram.com/scud.works/'>@scud.works</a>.<br><br>
        You can access this information and more in JSON format at <a target="_blank" href="https://internetradioprotocol.org/info">internetradioprotocol.org/info</a>.<br><br>
        If you have any questions, comments, or radio station addition suggestions, please email <a href="mailto:brayden@braydenmoore.com">brayden@braydenmoore.com</a> or open an issue on <a target="_blank" href="https://github.com/brayden1moore/internet-radio-protocol">Github</a>. <br><br>
        <!--Lastly, check out the tuner I am making:<br><br><a href="https://www.instagram.com/scud.works/" target="_blank" style="border:none !important; height:250px;"><img height="auto" width="100%" style="border: 1px solid black;" src="assets/sr.JPG"></a>-->
        Last updated <span class='last-updated'></span><span class='live-count'></span>
        
        <div id="scud-logo-div"><img id="scud-logo" src='/assets/scudlogo.png'></div>
        </body></html><style>

    .play-overlay {
        display: none;
        align-items: center;
        justify-content: center;
        width: 100%;
        height: 100%;
        position: absolute;
    }

    .logo-and-overlay:hover .play-overlay {
        display: flex;
    }

    #modal-station-location {
        background-color: #00BBFF;
        border: 1px solid black;
        width: fit-content;
        padding: 4px;
        margin-top: 7px;
    }

    #modal-description-container {
        margin-top: 16px;
    }

    .a-link {
        font-size: 8pt !important; 
        margin-right: 10px;
        flex: 1;
        text-align: center;
        border: 1px solid black;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .support-link {background-color:#FFFF00; }
    
    .info-link {display:none}

    #modal-links-container {
        margin-top: 20px;
        display: flex;
    }
    #modal-logo-container {
        display: flex;
        align-items: center;
    }

    #modal-station-name {
        width: fit-content;
        padding: 4px;
        padding-right: 9px;
        padding-left: 9px;
        color: white;
        background-color: black;
        font-size: 28px;
        /* letter-spacing: -0.06em; */
        font-family: 'Archivo Light';
    }

    #modal-name-and-location {
        margin-left: 10px;
    }

    #modal-content {
        padding: 30px;
        margin-top: -45px;
    }

    #modal-logo {
        height: 100%;
        width: 100%;
    }

    #modal-x-container {
        text-align: right;
        padding: 15px;
        justify-content: right;
        display: flex;
    }

    #modal-x {
        cursor: pointer;
        width: fit-content;
    }

    #modal-container {
        height: 100vh;
        width: 100vw;
        position: fixed;
        top: 0;
        left: 0;
        z-index: 10;
        display: none;
        justify-content: center;
        align-items: center;
    }

    #modal-bg {
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        opacity: 0.3;
        background-color: black;
    }

    #modal {
        width: 80%;
        z-index: 11;
        height: fit-content;
        background-color: white;
        border: 1px solid black;
    }

    #change-sort-button {
        margin-top: 20px;
        margin-left: -2px;
    }

    #change-sort-icon {
        cursor: pointer;
        height: 25px;
        opacity: 1;
    }
    #change-sort-icon:hover{
        opacity: 0.7;
    }

    #scud-logo {
        height: 40px;
    }

    #scud-logo-div {
        margin-top: 35px;
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    @keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
    }

    #shuffle {
        height: 30px;
    }

.a-station-container {
    animation: fadeIn 0.5s ease-out;
}
            
        #player-icons {
            margin-right: 15px;
            z-index: 2000;
        }

        #player-location {
            font-size: 8pt;
        }

    #player-name {
        font-size: 14pt;
        margin-bottom: 0;
        background-color: #000000;
        color: white;
        width: fit-content;
        margin-bottom: 3px;
        padding: 2px 4px;
    }

    #player-tags {
        margin-top: 5px;
        display: flex;
    }

       #play-icon {
        transform: rotate(90deg);
        }
        #play-icon {
        width: 30px;
        height: 30px;
        }

        body {
            color: black;
        }

        #pause-icon {
        height: 37px;
        width: 30px;
        display: none;
        }

        .player-paused {
            background-color: #FFF !important;
        }

        #player-info-div {
            display: block;
            overflow-x: hidden;
        }

        #player-info {
            font-size: 10pt !important;
        }

        #player-img {
            border: 1px solid black;
            height: 66px;
            margin-right: 15px;
            z-index: 1001;
        }

        #player-things {
            display: flex;
            align-items: center;
        }

        #player-icons {
            cursor: pointer;
        }

        #share-icon {
            position: fixed;
            right: 5px;
            z-index: 20;
            cursor: pointer;
            margin-left: auto;
            padding-right: 15px;
            font-size: 20pt;
        }
            
        #player {
            white-space: nowrap;
            /*justify-content: space-between;*/
            cursor: default;
            align-items: center;
            padding: 10px;
            padding-left: 15px;
            height: 70px;
            position: fixed;
            bottom: 0px;
            left: 0px;
            width: 100%;
            z-index: 1000;
            background-color: #00BBFF;
            border: 1px solid black;
            display: none;
        }
        ::-webkit-scrollbar {
        display: none;
        }
        .tag-container-container {
            margin-top: 22px;
            width: 100%;
        }
        .tags-container {
            scrollbar-width: thin;
            display: flex;
            flex-basis: 100%; height: 0;
            width: 100%;
            height: auto;
            overflow-x: scroll;
        }
        #location-tags-container {
            margin-top: 0px;
        }
        #status-tags-container {
            margin-top: 5px;
        }
        .active-tag {
            opacity: 1 !important;
        }
        .inactive-tag {
            opacity: 0.5 !important;
        }
        .status-tag {
            background-color: #FF4747;
        }
        .location-tag {
            background-color: #00BBFF;
        }
        .genre-tag {
            background-color: #00E7C0;
        }
        .tag {
            height: 15px;
            width: fit-content;
            cursor: pointer;
            /*border-radius: 20px;*/
            opacity: 1;
            border: 1px solid black;
            margin-right: 4px;
            padding: 6px;
            padding-bottom: 7px;
            padding-left: 9px;
            padding-right: 9px;
            margin-bottom: 4px;
            display: flex;
            flex-wrap: nowrap;
            flex-shrink: 0;
        }
        .tag:hover {
            opacity: 0.7;
        }

        #intro-div {
            padding: auto;
            text-align: left;
            justify-content: left;
            text-justify: left;
            display: flex;
            height: 54px;
            border: 1px solid black;
            background-color: black;
            color: white;
            align-items: center;
            padding-right: 15px;
            padding-left: 15px;   
        }

        #play-random {
            display: flex;
            align-items: center;
        }

        #play-random-button {
            cursor: pointer;
            width: auto;
            display: flex;
            background-color: yellow;
            border: 1px solid black;
            padding: 12px;
            margin-right: 8px;
            border-radius: 0px;
            font-size: 18pt;
            opacity: 1;
        }
        #play-random-button:hover {
            opacity: 0.7;
       }

        #play-random-text {
            cursor: pointer;
        }

        #title {
            margin-left: 0px;
        }
        

        .one-liner {
            font-size: 8pt;
        will-change: transform;
        backface-visibility: hidden;
        }

        .one-liner > div {
        will-change: transform;
        backface-visibility: hidden;
        }

        .one-liner > div:hover {
        animation-play-state: paused;
        }

        .one-liner span {
        transform: none !important;
        animation: none !important;
        will-change: transform;
        backface-visibility: hidden;
        }

        .flash {
        background-color: white !important;
        color: black !important;
        }

        .flash-out {
        transition: background-color 1s ease-out, color 1s ease-out;
        }

        .stream-name {
            width: fit-content;
            padding: 2px 4px;
            background-color:#000000 !important; color:#FFFFFF !important; font-size: 12pt;}
        .links {display:none; margin-top: 10px; margin-bottom: 2px;}


        #favorites-container {
            margin-top: 20px;
            padding-bottom: 45px;
            border-bottom: solid black 1px;
        }

        .big-top-margin {
            margin-top: 15px !important;
        }

        .favorite-star-favorited {
            font-size: 14pt;
            opacity: 0;
            color: yellow;
        }

        .now-playing {
            margin-top: 8px;
        }
        
        .favorite-star {
            font-size: 14pt;
            opacity: 0.2;
        }
        .favorite-star:hover {
            opacity: 1;
        }


        #main-logo {height: 100px; margin-left: -13px;
            animation: rotate 6s linear infinite;
        }

        .station-tag {
            font-size: 8pt;
            border:1px solid black;
            padding: 3px;
            margin-right: 4px;
        }
        .station-tag-div {
            margin-top: 5px;
            display: flex;
            overflow-x:scroll;
            padding-right: 15px;
        }
        .location-station-tag {
            background-color:#00BBFF;
        }
        .status-station-tag {
            background-color:#FF4747;
        }       
        .genre-station-tag {
            background-color:#00E7C0;
        }     
        .a-station-container {
            cursor: pointer;
            animation: fadeIn 0.5s ease-out forwards;
            position:relative; 
            border-radius: 0px;
              user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            isolation: isolate;
            overflow: auto;
            background-color: #FFFFFF; 
            color:#000000; height: 90px; padding: 10px; overflow-x:hidden; overflow-y:hidden; border:1px solid black; align-items: center; display: flex; white-space: nowrap;}
        .offline {
            opacity: 0.5;
        }
        .logo-and-overlay {
            position: relative;
            border-radius:0px; 
            width:90px; 
            height:90px; 
            margin-right:10px; 
            border: 1px solid black; 
            cursor: pointer; 
            flex-shrink: 0;
        }
        .a-logo {
            height: 100%;
            width: 100%;
        }
        body {background-color: #FFFFFF; font-size: 10pt; padding-bottom: 15vh !important;}
        .the-header {font-family: "Archivo Bold"; font-size: 40pt; line-height:0.75em; letter-spacing:-0.09em; margin-top:25px;margin-bottom:-10px;}
        .a-station {font-family: "Archivo Light"; font-size:8pt; white-space: nowrap; flex-shrink: 0;}
        
        @font-face {font-family: "Archivo Bold";src: url("assets/Archivo-Bold.ttf") format("truetype");}
        
        a {font-size: 10pt; color:#000000; border-bottom: 1px solid black; text-decoration: none;}
        a:hover {background-color: #000000; color:#FFFFFF}
       
        @font-face {font-family: "Archivo Light";src: url("assets/Archivo-Light.ttf") format("truetype");}
        @keyframes rotate{
            0% {
                transform: rotate(0deg)
            }
            100% {
                transform: rotate(360deg);
            }
        }
         @keyframes pulse{0%{background:#ffffff}50%{background:#ddd}100%{background:#ffffff}}.pulsing{animation:pulse 1s infinite}
        .streams-container {display: grid; grid-template-columns: 1fr; gap: 20px; margin-top: 5px; margin-bottom:15px;}
        @media (min-aspect-ratio: 8/10) 
        {
        
        #modal {
                width: 75%;
        }

        .stream-name {
            font-size: 14pt;
        }

        .one-liner {
            font-size: 10pt;
                    }

        #player-location {
            font-size: 10pt;
        }
        .tags-container {
            flex-wrap: nowrap;
        }
        .info-link {display:flex}
        body{font-size: 12pt;} 
        .a-link {font-size: 10pt !important;}
        .a-station-container {height:100px;} 
        .dragging {
            opacity: 0.5 !important;
        }
        .streams-container {grid-template-columns: 1fr 1fr;} 
        .the-header{
            margin-bottom: -20px;
            font-size: 50pt;
        } .a-station {font-size:10pt;}
        .logo-and-overlay {
            width:100px; 
            height:100px;
        }
        .a-logo {
            width: 100%;
            height: 100%;
        } 
        
            a {font-size: 12pt}
        #main-logo {height: 105px; margin-left:-15px}
        #title {margin-left: 0px;}
        }

        @media (orientation: landscape) 
        {
            #modal {
                width: 30%;
            }
            .streams-container {grid-template-columns: 1fr 1fr 1fr;} 
        }

        @media (min-width: 2000px) 
        {
            .streams-container {grid-template-columns: 1fr 1fr 1fr 1fr} 
        }
        </style><script>

        const modalContainer = document.getElementById('modal-container');
        function closeModal() {
            modalContainer.style.display = 'none';
        }

        const modalName = document.getElementById('modal-station-name');
        const modalLocation = document.getElementById('modal-station-location');
        const modalLogo = document.getElementById('modal-logo');
        const modalPlayOverlay = document.getElementById('modal-play-overlay');
        const modalDescription = document.getElementById('modal-description-container');
        const modalMainLink = document.getElementById('modal-main-link');
        const modalStreamLink = document.getElementById('modal-stream-link');
        const modalInfoLink = document.getElementById('modal-info-link');
        const modalSupportLink = document.getElementById('modal-support-link');

        function openModal(event, station) {
            modalContainer.style.display = 'flex';
            modalName.textContent = station;
            modalLocation.textContent = info[station]['location'];
            modalLogo.src = info[station]['logo'];
            if (info[station]['about']) {
                modalDescription.textContent = '"' + info[station]['about'] + '"';
            }

            modalMainLink.href = info[station]['mainLink'];
            modalStreamLink.href = info[station]['streamLink'];
            modalInfoLink.href = info[station]['infoLink'];
            modalSupportLink.href = info[station]['supportLink'];

            // set up play button
            modalPlayOverlay.onclick = function(event) {
                chooseStation(station);
            };
        }

        const introDiv = document.getElementById('intro-div');
        const introList = [
            `What's the matter Spotify boy, afraid you might hear something?`,
            `There is music at the bottom of the ocean.`,
            'The sound of the underground.',
            'The future of radio is on the internet.',
            'Are you a good listener?',
            '"I listen to the radio every day." -Cooper B. Handy',
            "For curious minds only."
        ]
        introDiv.textContent = introList[Math.floor(Math.random() * introList.length)];

        const player = document.getElementById('player');
        const playerImg = document.getElementById('player-img');
        const playerName = document.getElementById('player-name');
        const playerInfo = document.getElementById('player-info');
        const playerTags= document.getElementById('player-tags');
        const playerAudio = document.getElementById('player-audio');
        const playerIcons = document.getElementById('player-icons');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');

        playerIcons.addEventListener('click', togglePlayer);

        function togglePlayer() {
            document.querySelectorAll('.a-station-container').forEach(station=>{
                station.style.backgroundColor='white';
                station.classList.remove('pulsing')
            });
            
            const id = player.dataset.id;
            const theStation = document.getElementById(id);  

            if (playerAudio.paused) {
                playerAudio.load();
                theStation.classList.add('pulsing');           
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
                player.classList.remove('player-paused');
                player.classList.add('pulsing');                
                playerAudio.play().then(()=>{
                    player.classList.remove('pulsing');      
                    theStation.classList.remove('pulsing');          
                    theStation.style.backgroundColor = 'yellow';
                });
            }
            else {
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
                playerAudio.pause();
                player.classList.add('player-paused');
            }
        }

        let currentPositionInPrev = 0;
        let previousStations = [];
        function chooseStation(id, random=false, fromLink=false, fromHistory=false) {
            if (player.dataset.id && !fromHistory) {
                previousStations.push(player.dataset.id);
            }
            document.title = `${id} - Internet Radio Protocol`;

            player.style.display = 'flex';

            let d=document.getElementById(id)
            let isPlaying=d.style.backgroundColor==='yellow';

            const randomButton = document.getElementById('play-random-button');
            const playRandomText = document.getElementById('play-random-text');

            const station = document.getElementById(id)
            const oneLiner = station.dataset.oneLiner;
            const logo = station.querySelector('.a-logo').src;
            document.querySelectorAll('meta[property=og\\:image]')[0].setAttribute('content', logo.replace('https://internetradioprotocol.org',''))


            playerImg.src = logo;
            player.dataset.id = id;
            playerName.textContent = id;

            const a=document.getElementById(`${id}-audio`);
            playerAudio.src = a.dataset.src; 

            updatePlayer(id, oneLiner, station.dataset.location);
            updateMediaSession(oneLiner, id, logo);
            if (!fromLink) {
                player.classList.add('pulsing');
                togglePlayer();
            }
        }
                        
        document.querySelectorAll('.last-updated').forEach(el => {const utcStr = el.dataset.utc;if (utcStr) {const date = new Date(utcStr);if (!isNaN(date)) {el.textContent = date.toLocaleString();}}});

        function playRandom() {
            let alreadyPlaying = true;
            let offline = true;
            const stationContainers = document.querySelectorAll('.a-station-container');
            const idList = Array.from(stationContainers).map(container => container.id);
            let oneLiner = '';
            let id = '';
            while (alreadyPlaying || offline) {
                let choice = Math.floor(Math.random() * idList.length);
                id = idList[choice];
                alreadyPlaying = !document.getElementById(`${id}-audio`).paused;
                offline = document.getElementById(id).dataset.status == "Offline";
                if (!alreadyPlaying && !offline) {
                        const container = document.getElementById(id);
                        oneLiner = container.dataset.oneLiner;
                }
            }
            chooseStation(id, true);
        }

        const playRandomButton = document.getElementById('play-random-button');
        playRandomButton.addEventListener('click', playRandom);

        const playRandomTextElement = document.getElementById('play-random-text');
        playRandomTextElement.addEventListener('click', function() {
            const previewSpan = playRandomTextElement.querySelector('span');
            const id = previewSpan.id.replace('previewFor-', '');
            element = document.getElementById(id)
            const yOffset = -1 * (window.innerHeight / 2) + 100;
            const y = element.getBoundingClientRect().top + window.scrollY + yOffset;
            window.scrollTo({top: y, behavior: 'smooth'});
        });

        function calculateMarquees(stationContainers) {
            stationContainers.forEach((container) => {
                const logo = container.querySelector('.a-logo');
                const nowPlaying = container.querySelector('.now-playing');
                const oneLiner = nowPlaying.querySelector('.one-liner');
                
                const availableWidth = container.offsetWidth - logo.offsetWidth - 10; // 30px padding
                const oneLinerContentWidth = oneLiner.scrollWidth;
                const needsMarquee = oneLinerContentWidth > availableWidth;
                
                if (needsMarquee) {
                    const width = availableWidth + 'px';
                    setupOneLinerMarquee(oneLiner, width, 'left');
                }
            });
        }

        function setupOneLinerMarquee(oneLinerElement, width, direction = 'left') {
            const text = oneLinerElement.textContent;
            const textLength = text.length;
            
            const wrapper = document.createElement('div');
            wrapper.style.cssText = `
                overflow: hidden;
                white-space: nowrap;
                display: inline-block;
                width: ${width};
                position: relative;
                top: 3px;
                will-change: transform;
                backface-visibility: hidden;
            `;
            
            const scrollContainer = document.createElement('div');
            scrollContainer.style.cssText = `
                display: inline-block;
                white-space: nowrap;
                will-change: transform;
                backface-visibility: hidden;
            `;
            
            const originalSpan = document.createElement('span');
            originalSpan.classList.add('marqueeOneLiner');
            originalSpan.textContent = text;
            originalSpan.style.cssText = `
                display: inline-block;
                margin-right: 40px;
                will-change: transform;
                backface-visibility: hidden;
            `;
            
            const clonedSpan = originalSpan.cloneNode(true);
            
            scrollContainer.appendChild(originalSpan);
            scrollContainer.appendChild(clonedSpan);
            oneLinerElement.innerHTML = '';
            oneLinerElement.appendChild(wrapper);
            wrapper.appendChild(scrollContainer);
            
            scrollContainer.offsetHeight;
            
            const computedStyle = window.getComputedStyle(originalSpan);
            const marginRight = parseFloat(computedStyle.marginRight) || "10px";
            const totalWidth = originalSpan.offsetWidth + marginRight;
            const duration = totalWidth / 25; 
            
            const uid = Math.random().toString(36).substr(2, 5);
            const animName = `scroll-oneliner-${direction}-${uid}`;
            
            const styleElement = document.createElement('style');
            
            if (direction === 'left') {
                scrollContainer.style.transform = 'translateX(0px)';
                styleElement.textContent = `
                @keyframes ${animName} {
                    0% { transform: translateX(0px); }
                    20% { transform: translateX(0px); }
                    100% { transform: translateX(-50%); }
                }
                `;
            } else {
                scrollContainer.style.transform = 'translateX(-50%)';
                styleElement.textContent = `
                @keyframes ${animName} {
                    0% { transform: translateX(-50%); }
                    100% { transform: translateX(0px); }
                }
                `;
            }
            
            document.head.appendChild(styleElement);
            
            scrollContainer.style.cssText += `
                animation-name: ${animName};
                animation-duration: ${duration}s;
                animation-timing-function: linear;
                animation-iteration-count: infinite;
                animation-fill-mode: forwards;
                will-change: transform;
                backface-visibility: hidden;
                transform: translateZ(0);
            `;
        }


        function decodeHtmlEntities(text) {
            const textarea = document.createElement('textarea');
            textarea.innerHTML = text;
            return textarea.value;
        }

        let locationTagActive = false;
        let statusTagActive = false;
        let genreTagActive = false;
        let activeLocationTags = [];
        let activeStatusTags = [];
        let activeGenreTags = [];

        function resetTags() {
            const theseTags = document.querySelectorAll(`.${tagType}-tag`);
            theseTags.forEach(otherTag => {
                otherTag.classList.remove('active-tag');
            });
        }
        function toggleTag(tag) {
            const tagType = tag.dataset.type;
            const stations = document.querySelectorAll('.a-station-container');
            const theseTags = document.querySelectorAll(`.tag`)
            const tagsInRow = document.querySelectorAll(`.${tagType}-tag`);

            // update tag divs
            if (tag.classList.contains('active-tag')) {
                tag.classList.remove('active-tag');
            }
            else {
                tag.classList.add('active-tag');
            }

            // get active tag list
            activeLocationTags = [];
            activeStatusTags = [];
            activeGenreTags = [];
            locationTagActive = false;
            statusTagActive = false;
            genreTagActive = false;

            theseTags.forEach(thisTag => {
                if (thisTag.dataset.type == 'location') {
                    if (thisTag.classList.contains('active-tag')) {
                        locationTagActive = true;
                        activeLocationTags.push(thisTag.id.replace('-tag',''));               
                    }      
                }
                else if (thisTag.dataset.type == 'status') {
                    if (thisTag.classList.contains('active-tag')) {
                        statusTagActive = true;
                        activeStatusTags.push(thisTag.id.replace('-tag',''));               
                    }            
                }   
                else if (thisTag.dataset.type == 'genre') {
                    if (thisTag.classList.contains('active-tag')) {
                        genreTagActive = true;
                        activeGenreTags.push(thisTag.id.replace('-tag',''));               
                    }         
                }   
            });

            // Determine which list to use based on the clicked tag type
            let thisTagList;
            if (tagType == 'location') {
                thisTagList = activeLocationTags;
            } else if (tagType == 'status') {
                thisTagList = activeStatusTags;
            } else if (tagType == 'genre') {
                thisTagList = activeGenreTags;
            }

            // update tags in row
            tagsInRow.forEach(tagInRow => {
                if ((!thisTagList.includes(tagInRow.id.replace('-tag',''))) && (thisTagList.length > 0)) {
                    tagInRow.classList.add('inactive-tag');
                } else {
                    // Remove inactive-tag if it should be active
                    tagInRow.classList.remove('inactive-tag');
                }
            });
            
            // update station divs
            stations.forEach(station => {
                station.style.display = 'flex';
                if (
                    (activeLocationTags.includes(station.getAttribute(`data-location`)) | activeLocationTags.length==0) 
                    & (activeStatusTags.includes(station.getAttribute(`data-status`)) | activeStatusTags.length==0) 
                    & (activeGenreTags.some(genre => {return station.getAttribute(`data-genres`).includes(genre);}) | activeGenreTags.length==0)
                ) {
                    station.style.display = 'flex';
                }
                else {
                    station.style.display = 'none';
                    /*
                    if (station.dataset.favorited !== 'true') {
                        station.style.display = 'none';
                    }
                    */
                }
            })

        }

          

        function updatePlayer(id, oneLiner, location) {
            existingStation = document.getElementById(id);
            oneLinerElement = playerInfo.querySelector('.one-liner');
            existingOneLiner = decodeHtmlEntities(oneLinerElement.dataset.oneLiner)
            const shareIconDiv = document.getElementById('share-icon');

            if (existingOneLiner != oneLiner) {
                oneLinerElement.textContent = oneLiner;
                playerTags.innerHTML = existingStation.querySelector(".station-tag-div").innerHTML;
                oneLinerElement.textContent = oneLiner;
                oneLinerElement.dataset.oneLiner = oneLiner; 
            };

            const width = window.innerWidth - shareIconDiv.offsetWidth - playerImg.offsetWidth - playerIcons.offsetWidth - 80;
            needsMarquee = playerInfo.scrollWidth > width;   

            console.log('width');
            console.log(width);
            console.log('playerinfo width');
            console.log(playerInfo.scrollWidth);

            if (needsMarquee) {
                setupOneLinerMarquee(oneLinerElement, width + 'px', 'left');
            };

            playerInfo.style.width = width + 'px';
        }

        function orderStations(by, keys=null) {
            const icon = document.getElementById('change-sort-icon');
            icon.src = 'assets/' + by + '.png';

            container = document.getElementById('streams-container');
            if (keys) {
                stations = keys;
            }
            else {
                stations = Array.from(container.querySelectorAll('.a-station-container')); 
            }

            container.innerHTML = "";
            console.log(stations);
            
            if (by=='random') {
                for (let i = stations.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [stations[i], stations[j]] = [stations[j], stations[i]]; 
                }
            }
            else if (by=='ascending') {
                let lowerA, lowerB;
                stations.sort((a, b) => {
                    if (keys) {
                        lowerA = a.toLowerCase();
                        lowerB = b.toLowerCase();
                    }
                    else {
                        lowerA = a.id.toLowerCase();
                        lowerB = b.id.toLowerCase();
                    }

                    if (lowerA < lowerB) {
                        return -1;
                    }
                    if (lowerA > lowerB) {
                        return 1;
                    }
                    return 0; 
                });
            }
            else if (by=='descending') {
                stations.sort((a, b) => {
                    let lowerA, lowerB;
                    if (keys) {
                        lowerA = a.toLowerCase();
                        lowerB = b.toLowerCase();
                    }
                    else {
                        lowerA = a.id.toLowerCase();
                        lowerB = b.id.toLowerCase();
                    }
                    if (lowerA > lowerB) {
                        return -1;
                    }
                    if (lowerA < lowerB) {
                        return 1;
                    }
                    return 0; 
                });                
            }
            
            if (keys) {
                return stations;
            }
            else {
                stations.forEach((station) => {
                    console.log(station);
                    container.appendChild(station);
                })
            }

            localStorage.setItem('sortOrder',by);
        }

        function sortStations(toggle=false) {
            currentOrder = localStorage.getItem('sortOrder') || 'random';
            if (toggle) {
                if (currentOrder=='random') {
                    orderStations('ascending');
                }
                else if (currentOrder=='ascending') {
                    orderStations('descending');
                }
                else if (currentOrder=='descending') {
                    orderStations('random');
                }
            }
            else {
                orderStations(currentOrder);
            }
        }

        function populateStations(data, needSort=false) {
            var rerun = 0;
            var live = 0;
            var offline = 0;
            const keys = Object.keys(data);

            if (needSort) {
                currentOrder = localStorage.getItem('sortOrder') || 'random';
                orderStations(currentOrder, keys);
            }

            const container = document.getElementById('streams-container');
            const updatedOneLiners = [];
            const offliners = [];

            keys.forEach(function(stationName) {
                const station = data[stationName];
                const oneLiner = decodeHtmlEntities(data[stationName]['oneLiner']);
                const location = data[stationName]['location'];
                const genres = data[stationName]['genres'];
                const status = data[stationName]['status'];
                const streamLink = data[stationName]['streamLink'];
                const mainLink = data[stationName]['mainLink'];
                const infoLink = data[stationName]['infoLink'];
                const donateLink = data[stationName]['supportLink'];
                const logo = data[stationName]['logo'];
                const hidden = data[stationName]['hidden'];
                
                const existingStation = document.getElementById(stationName);
                if (existingStation) {
                    existingOneLiner = decodeHtmlEntities(existingStation.dataset.oneLiner);
                    if (existingOneLiner != oneLiner) {
                        existingStation.querySelector('.one-liner').textContent = oneLiner;
                        existingStation.dataset.oneLiner = oneLiner; 
                        updatedOneLiners.push(existingStation);

                        existingStation.querySelector('.status').textContent = status;
                        existingStation.querySelector('.location').textContent = location;

                        stationTags = existingStation.querySelector('.station-tag-div');
                        stationTags.innerHTML = `
                                <div class="status station-tag status-station-tag">${status}</div>
                                <div class="location location-station-tag station-tag">${location}</div>`;
                        if (genres) {
                            genres.forEach(genre => {
                                const genreTag = document.createElement('div');
                                genreTag.classList.add('station-tag');
                                genreTag.classList.add('genre-station-tag');
                                genreTag.textContent = genre;
                                stationTags.appendChild(genreTag);
                            });
                        }
                        stationTags.style.width = existingStation.offsetWidth - 120 - 20 + 'px';
                    };

                    existingStation.dataset.location = location;
                    existingStation.dataset.status = status;
                    existingStation.dataset.genres = genres;

                    if (existingStation.id == player.dataset.id) {
                        updatePlayer(stationName, oneLiner, location);
                        updateMediaSession(oneLiner, stationName, logo);
                    }
                }
                else {
                    const stationDiv = document.createElement('div');
                    stationDiv.classList.add('a-station-container');
                    stationDiv.dataset.location = location;
                    stationDiv.dataset.status = status;
                    stationDiv.dataset.oneLiner = oneLiner; 
                    stationDiv.dataset.genres = genres;
                    stationDiv.onclick = function(event) {
                        if (event.target.closest('.logo-and-overlay')) {
                            return;
                        }
                        openModal(event, stationName);
                    };
                    stationDiv.setAttribute('draggable', true);
                    stationDiv.id = stationName;    
                              
                    stationDiv.innerHTML = `
                    <p class="favorite-star-favorited" id="${stationName}-favorite" style="position: absolute; top: 10px; right: 10px; margin: 0; cursor: pointer; z-index: 10;">★</p>
                    <p class="favorite-star" onClick="toggleFavorite('${stationName}')"  id="${stationName}-favorite-outline" style="position: absolute; top: 10px; right: 10px; margin: 0; cursor: pointer; z-index: 11;">☆</p>
                    <div class="logo-and-overlay">
                        <div class="play-overlay" onclick="chooseStation('${stationName}')">
                            <svg viewBox="0 0 100 100" width="60%" height="60%">
                                <polygon points="30,20 30,80 75,50" fill="white" stroke="black" stroke-width="2"/>
                            </svg>
                        </div>
                        <img class="a-logo"  src="${logo}"  />
                    </div>
                    <div class="a-station">
                    <div class="stream-name" target="_blank" href="${mainLink}">${stationName}</div>
                    <div class="links">
                        <a class="a-link" target="_blank" href="${streamLink}">Stream</a>
                        <a class="a-link" target="_blank" href="${mainLink}">Website</a>
                        <a class="a-link info-link" target="_blank" href="${infoLink}">Info</a>
                        <a class="a-link support-link" target="_blank" href="${donateLink}">Donate</a>
                    </div>
                    <div class="now-playing"><div id="${stationName}-oneLiner" class="one-liner">${oneLiner}</div></div>
                    <div class="station-tag-div">
                        <div class="status station-tag status-station-tag">${status}</div>
                        <div class="location location-station-tag station-tag">${location}</div>
                    </div>
                    <audio id="${stationName}-audio" style="width:40px;" data-src="${streamLink}"></audio>
                    </div>`

                    if (hidden != true) {
                        if (status === 'Offline') {
                            stationDiv.classList.add('offline');
                            offliners.push(stationDiv);
                        }
                        else {
                            container.appendChild(stationDiv);
                        }
                        stationTags = stationDiv.querySelector('.station-tag-div');
                        if (genres) {
                            genres.forEach(genre => {
                                const genreTag = document.createElement('div');
                                genreTag.classList.add('station-tag');
                                genreTag.classList.add('genre-station-tag');
                                genreTag.textContent = genre;
                                stationTags.appendChild(genreTag);

                            });
                        }
                        stationTags.style.width = stationDiv.offsetWidth - 120 - 20 + 'px';
                    }

                    updatedOneLiners.push(stationDiv);
                }

                if (hidden != true) {
                    if (status === 'Offline') {
                        offline++;
                    }
                    else {
                        if (status === 'Re-Run') {
                            rerun++;
                        }
                        else {
                            live++;
                        }
                    }
                }
            
            });

            // add offline stations last
            offliners.forEach(station => {
                container.appendChild(station);
            })
            
            const liveCount = document.querySelector('.live-count');
            liveCount.textContent = ` - ${live + offline + rerun} total, ${live + rerun} online, ${live} live, ${offline} offline`;
            
            const lastUpdated = document.querySelector('.last-updated');
            const now = new Date();
            const formatter = new Intl.DateTimeFormat('en-US', {
                weekday: 'short',
                month: 'short',
                day: 'numeric',
                hour: 'numeric',
                minute: '2-digit',
                hour12: true
            });
            
            lastUpdated.textContent = formatter.format(now);
            lastUpdated.classList.add('flash');
            setTimeout(function() {
                lastUpdated.classList.add('flash-out');
                lastUpdated.classList.remove('flash');
            }, 100);
            setTimeout(function() {
                lastUpdated.classList.remove('flash-out');
            }, 1100);

            calculateMarquees(updatedOneLiners);
        }

        function populateTags(data) {
            // create locations and genres
            const locationTagsContainer = document.getElementById('location-tags-container');
            locationTagsContainer.innerHTML = "";
            const genreTagsContainer = document.getElementById('genre-tags-container');
            genreTagsContainer.innerHTML = "";

            const locations = [];
            const genres = [];

            Object.keys(data).forEach(function(stationName) {
                thisLocation = data[stationName]['location'];
                if (!locations.includes(thisLocation)) {
                        locations.push(thisLocation);
                }

                theseGenres = data[stationName]['genres'];
                if (theseGenres) {
                    theseGenres.forEach(thisGenre => {
                        if (!genres.includes(thisGenre)) {
                                genres.push(thisGenre);
                        }                    
                    })
                }
            });

            locations.sort();
            locations.forEach(location => {
                const locationTag = document.createElement('div');
                locationTag.id = `${location}-tag`;
                locationTag.classList.add('location-tag');
                locationTag.classList.add('tag');
                locationTag.textContent = location.replace(/ /g, "\u00A0");
                locationTag.dataset.type = "location";
                locationTagsContainer.appendChild(locationTag);
                locationTag.addEventListener('click',function() {
                    toggleTag(locationTag);
                });
            });
            
            genres.sort();
            genres.forEach(genre => {
                const genreTag = document.createElement('div');
                genreTag.id = `${genre}-tag`;
                genreTag.classList.add('genre-tag');
                genreTag.classList.add('tag');
                genreTag.textContent = genre.replace(/ /g, "\u00A0");
                genreTag.dataset.type = "genre";
                genreTagsContainer.appendChild(genreTag);
                genreTag.addEventListener('click',function() {
                    toggleTag(genreTag);
                });
            });
        }
        
        // add event listener to statuses
        const statusTags = document.querySelectorAll('.status-tag');
        statusTags.forEach(status => {
            status.addEventListener('click',function() {
                toggleTag(status);
            });
        })

        function updateMediaSession(title, artist, artwork) {
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                title: title,
                artist: artist,
                album: 'Internet Radio Protocol',
                artwork: [
                    { src: artwork, sizes: '96x96',   type: 'image/png' },
                    { src: artwork, sizes: '128x128', type: 'image/png' },
                    { src: artwork, sizes: '256x256', type: 'image/png' },
                    { src: artwork, sizes: '512x512', type: 'image/png' }
                ]
                });

                navigator.mediaSession.setActionHandler('play', () => {
                togglePlayer();
                });
                
                navigator.mediaSession.setActionHandler('pause', () => {
                togglePlayer();
                });

                navigator.mediaSession.setActionHandler('nexttrack', () => {
                    if (currentPositionInPrev >= previousStations.length) {
                        playRandom();
                    }
                    else {
                        chooseStation(previousStations[currentPositionInPrev], fromHistory=true)
                    }
                    currentPositionInPrev += 1;
                });

                navigator.mediaSession.setActionHandler('previoustrack', () => {
                    if (currentPositionInPrev >= 0) {
                        chooseStation(previousStations[currentPositionInPrev], fromHistory=true);
                    }
                    currentPositionInPrev -= 1;
                });                
            }
        }

        let firstLoad = true;
        let info;
        function getUpdatedInfo(from_endpoint=true) {
            let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            info = JSON.parse(localStorage.getItem('info'));

            if (info && from_endpoint == false) {
                json = info;
                
                populateStations(json, needSort=firstLoad);

                if (locationTagActive == false & statusTagActive == false & genreTagActive == false) {
                    populateTags(json);
                }
                
            } else {
                fetch(`https://internetradioprotocol.org/info?cacheBust=${Math.random()}`)
                    .then(response => response.json())
                    .then(json => {
                        if (firstLoad) {
                            populateStations(json, needSort=true);
                            distributeFavorites(favorites);
                        }
                        else {
                            populateStations(json);
                        }

                        if (locationTagActive == false & statusTagActive == false & genreTagActive == false) {
                            populateTags(json);
                        }
                        localStorage.setItem('info', JSON.stringify(json));
                    })
                    .catch(error => console.error('Fetch error:', error));
            }

            firstLoad = false;
        }

        function distributeFavorites(favorites) {
            const favoriteDiv = document.getElementById('favorites-container');
            const originalContainer = document.getElementById('streams-container');
            
            if (favorites.length == 0) {
                favoriteDiv.style.display = "none";
                originalContainer.classList.remove('big-top-margin');
            } else {
                favoriteDiv.style.display = "grid";
                originalContainer.classList.add('big-top-margin');
            }
            
            const allFavoriteStations = favoriteDiv.querySelectorAll('.a-station-container');
            allFavoriteStations.forEach((station) => {
                
                originalContainer.insertBefore(station, originalContainer.firstChild);
                
                station.dataset.favorited = 'false';
                
                let favoriteStar = station.querySelector('.favorite-star-favorited');
                let favoriteOutline = station.querySelector('.favorite-star');
                
                if (favoriteStar) favoriteStar.style.opacity = '0';
                if (favoriteOutline) favoriteOutline.style.opacity = '0.2';

            });
            
            favorites.forEach((stationId) => {
                let stationDiv = document.getElementById(stationId);
                if (stationDiv) {
                    stationDiv.dataset.favorited = 'true';

                    let favoriteStar = stationDiv.querySelector('.favorite-star-favorited');
                    let favoriteOutline = stationDiv.querySelector('.favorite-star');
                    
                    if (favoriteStar) favoriteStar.style.opacity = '1';
                    if (favoriteOutline) favoriteOutline.style.opacity = '1';

                    favoriteDiv.appendChild(stationDiv);
                }
            });
        }

        function toggleFavorite(id) {
            let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            const index = favorites.indexOf(id);
            if (index > -1) {
                favorites.splice(index, 1);
            } else {
                favorites.push(id);
            }
            localStorage.setItem('favorites', JSON.stringify(favorites));
            distributeFavorites(favorites);
        }

        document.addEventListener('DOMContentLoaded', () => {
            let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            distributeFavorites(favorites);

            // get station from URL
            const params = new Proxy(new URLSearchParams(window.location.search), {
                get: (searchParams, prop) => searchParams.get(prop),
            });
            let value = params.station;
            if (value) {
                chooseStation(value, false , true);
            }
        });

      const shareIcon = document.getElementById("share");
      const copiedText = document.getElementById("copied");

      shareIcon.addEventListener("click", function() {
          const id = player.getAttribute("data-id").replaceAll(" ","%20");
          const urlToCopy = `${window.location.origin}/?station=${id}`;
          
          navigator.clipboard.writeText(urlToCopy).then(() => {
              console.log("URL copied to clipboard");
              shareIcon.className = "fa-solid fa-check";
              //copiedText.style.visibility = "visible";
          }).catch(err => {
              console.log("Could not copy text: ", err);
          });
      });
        
        getUpdatedInfo(false);

        getUpdatedInfo(true);

        setTimeout(() => {
            setInterval(getUpdatedInfo, 10000);
        }, 1000);

        </script>
